<section class="main-content-wrapper">
    <section class="content-header">
        <div class="row">
            <div class="col-md-6">
                <h2 class="top-left-header">Kitchen</h2>
                <input type="hidden" class="datatable_name" data-title="Tables" data-id_name="datatable">
            </div>
            <div class="col-md-6">
                <div class="top_menu_right me-2 btn bg-blue-btn" title="Refresh Orders">
                    <p class="m-0" (click)="getAllOrders()">
                        <i class="fas fa-sync-alt ir_mouse_pointer" id="refresh_orders_button"></i>
                    </p>
                </div>
                <div class="top_menu_right me-2 btn bg-blue-btn" title="Notifications">
                    <p class="m-0">
                        <i class="fas fa-bell "></i>
                    </p>
                </div>
            </div>
        </div>
    </section>
    <div class="row">
        <ng-container *ngFor="let p of responseOrder">
            <ng-container *ngIf="p.statusID != 6 && p.statusID != 7 && p.statusID != 8">
                <div class="col-md-3" style="padding-right: 10px;">
                    <div class="card mb-3">
                        <div class="card-body"
                            [ngClass]="{'newOrderClass':p.statusID == 3, 'inQueueClass': p.statusID == 4, 'readyClass':p.statusID == 5}">
                            <div class="row">
                                <div class="col-md-7">
                                    <p class="card-title" *ngIf="p.statusID == 3">NEW_ORDER</p>
                                    <p class="card-title" *ngIf="p.statusID == 4">IN_QUEUE</p>
                                    <p class="card-title" *ngIf="p.statusID == 5">READY</p>
                                </div>
                                <div class="col-md-5">
                                    <p class="card-title float-end"><i class="fas fa-stopwatch"></i>
                                        {{p.minute.minutes}}:{{p.minute.seconds}}</p>
                                </div>
                            </div>
                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Order Type: {{p.orderType}}</li>
                            <ng-container *ngIf="p.tableDetail.length > 0">
                                <ng-container *ngFor="let table of p.tableDetail">
                                    <li class="list-group-item">Table: {{table.tableName}}</li>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="p.tableDetail.length == 0">
                                <li class="list-group-item">Table: </li>
                            </ng-container>
                            <li class="list-group-item">Order No: {{p.kotNO}}</li>
                        </ul>
                        <div class="card-body" style="padding-top: 0px;">
                            <div class="row mt-4">
                                <div class="col-md-3">
                                    <button type="button" class="w-100 btn bg-blue-btn"
                                        style="background-color: rgb(255 177 0);" (click)="viewOrder(p)"
                                        data-toggle="modal" data-target="#OrderViewModal">View</button>
                                </div>
                                <div class="col-md-3">
                                    <button type="button" class="w-100 btn bg-blue-btn"
                                        style="background-color:  rgb(72, 216, 0);" [disabled]="p.statusID != 3"
                                        (click)="changeStatus(p)">Start</button>
                                </div>
                                <div class="col-md-3">
                                    <button type="button" class="w-100 btn bg-blue-btn"
                                        style="background-color: rgb(23 161 175);" [disabled]="p.statusID != 4"
                                        (click)="changeStatus(p)">Ready</button>
                                </div>
                                <div class="col-md-3">
                                    <button type="button" class="w-100 btn bg-blue-btn" (click)="changeStatus(p)"
                                        [disabled]="p.statusID != 5"
                                        style="background-color: #f15a29; color: white;">Collected</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- <div class="card mb-3"
                        [ngStyle]="{'background-color': p.statusID == 3 ? 'rgb(66 161 66)' : 'rgb(23 161 175)'}">
                        <div class="card-body">
                            <div class="row mb-2" style="color: black;"
                                [ngStyle]="{'background-color': p.statusID == 3 ? 'rgb(155 255 155)' : 'rgb(163 246 255)'}">
                                <div class="col-md-6">
                                    <p class="card-text">{{p.orderType}}</p>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text float-end" *ngIf="p.statusID == 3">NEW_ORDER</p>
                                    <p class="card-text float-end" *ngIf="p.statusID == 4">IN_QUEUE</p>
                                </div>
                            </div>
                            <div class="row mb-2" style="color: black;"
                                [ngStyle]="{'background-color': p.statusID == 3 ? 'rgb(155 255 155)' : 'rgb(163 246 255)'}">
                                <div class="col-md-4">
                                    <ng-container *ngFor="let table of p.tableDetail">
                                        <p class="card-text">{{table.tableName}}</p>
                                    </ng-container>
                                </div>
                                <div class="col-md-8">
                                    <p class="card-text float-end">#{{p.kotNO}}</p>
                                </div>
                            </div>

                            <div class="btn_box">
                                <div class="row mt-4">
                                    <div class="col-md-3">
                                        <button type="button" class="w-100 btn bg-blue-btn"
                                            (click)="cancelOrderNotConfirm(p)"
                                            style="background-color: rgb(237, 0, 0); color: white;">Cancel</button>
                                    </div>
                                    <div class="col-md-3">
                                        <button type="button" class="w-100 btn bg-blue-btn"
                                            style="background-color: rgb(255, 225, 0);" (click)="viewOrder(p)"
                                            data-toggle="modal" data-target="#OrderViewModal">View</button>
                                    </div>
                                    <div class="col-md-3">
                                        <button type="button" class="w-100 btn bg-blue-btn"
                                            style="background-color: blueviolet;" [disabled]="p.statusID != 3"
                                            (click)="changeStatus(p)">Start</button>
                                    </div>
                                    <div class="col-md-3">
                                        <button type="button" class="w-100 btn bg-blue-btn"
                                            style="background-color: rgb(72, 216, 0);" [disabled]="p.statusID != 4"
                                            (click)="changeStatus(p)">Ready</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->
                </div>
            </ng-container>
        </ng-container>
    </div>
</section>


<div class="modal fade  come-from-modal left" id="OrderViewModal" tabindex="-1" role="dialog" data-backdrop="static"
    data-keyboard="false" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" #closeOrderViewModal><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Order Detail</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="form-group">
                        <div class="table-box anyClassThree">
                            <div class="table-responsive">
                                <table id="datatable" class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Item Name</th>
                                            <th>Qty</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let p of POSNewModelRequest.requestKotDetail let ndx=index;">
                                            <td *ngIf="!p.variantID && !p.dealID">
                                                {{p.foodItemName}}</td>
                                            <td *ngIf="p.variantID && !p.dealID">
                                                {{p.foodItemName}} ({{p.variantName}})
                                            </td>
                                            <td *ngIf="p.dealID">{{p.dealName}}</td>
                                            <td>
                                                {{p.quantity}}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="form-group">
                                    <label>Remarks</label>
                                    <textarea class="form-control" style="height: 70px;"
                                        readonly>{{POSNewModelRequest.requestKot.remarks}}</textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" (click)="resetOrder()">Close</button>
            </div>
        </div>
    </div>
</div>